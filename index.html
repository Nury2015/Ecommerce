<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Página principal</title>
    <link rel="stylesheet" href="index.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <nav>
      <a href="menumobile.html">
        <img src="icons/icon_menu.svg" alt="menu" class="menu" />
      </a>

      <div class="navbar-left">
        <a href="index.html">
          <img src="logos/logo_yard_sale.svg" alt="logo" class="logo" />
        </a>

        <ul>
          <li>
            <a href="Misordenes.html"> Tus pedidos </a>
          </li>

          <li>
            <a href="index.html">Clothes</a>
          </li>

          <li>
            <a href="index.html">Electronics</a>
          </li>

          <li>
            <a href="index.html">Furnitures</a>
          </li>

          <li>
            <a href="index.html">Toys</a>
          </li>

          <li>
            <a href="index.html">Others</a>
          </li>
        </ul>
      </div>

      <div class="navbar-right">
        <ul>
          <li class="navbar-email">
            <a href="editar-cuenta.html"> camila@gmail.com </a>
          </li>

          <li class="navbar-shopping-cart">
            <a id="ver-carrito">
              <img src="icons/icon_shopping_cart.svg" alt="shopping cart" />
              <div>0</div>
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <section class="main-container">
      <div class="card-container" id="card-container"></div>
    </section>

    <footer>© <span id="year"></span> DECAYBA · Hecho con ❤</footer>

    <script>
      const cartContent = document.getElementById("card-container");
      const productos = [
        {
          nombre: "Peluche para perro",
          valor: "$50.000",
          descripcion:
            "Juguete para Perros de Pato Peluche con Sonido - Resistente al Mordisco, Juguete Suave para Masticar para Razas Medianas y Pequeñas con efectos de Sonido Interactivos, Ideal para Jugar y Entrenamiento, Juguetes para Perros",
          imagen: "img/peluche/perroabrazando.webp",
          imgs: [
            "img/peluche/peluche.webp",
            "img/peluche/medidas.webp",
            "img/peluche/perroabrazando.webp",
            "img/peluche/perrocon.webp",
          ],
        },
        {
          nombre: "Botón para perros",
          valor: "$50.000",
          imagen: "img/Boton/principal.webp",
          descripcion:
            "Botón de comunicación para mascotas, perro que habla, botón interactivo de entrenamiento de sonido, grabador de sonido",
          imgs: [
            "img/Boton/principal.webp",
            "img/Boton/funcion.webp",
            "img/Boton/cantidad.webp",
            "img/Boton/medidas.webp",
          ],
        },
        {
          nombre: "Cepillo para mascotas",
          valor: "40.000",
          imagen: "img/Cepillo/pelo.webp",
          descripcion:
            "Peine para Mascotas de Fácil Limpieza y Confort Diario, Adecuado para Perros y Gatos con Función Desenredante, Mango Ergonómico, Peine para Pelaje y Cuidado, Gran Ayudante en la Higiene Canina",
          imgs: [
            "img/Cepillo/prrincipal.webp",
            "img/Cepillo/pelo.webp",
            "img/Cepillo/princi.webp",
            "img/Cepillo/medidas.webp",
            "img/Cepillo/boton.webp",
            "img/Cepillo/princi.webp",
            "img/Cepillo/rosado.webp",
          ],
        },
        {
          nombre: "Peluche para mascotas",
          valor: "$120.000",
          imagen: "img/ganzo/princi.webp",
          descripcion:
            "Juguete para Perros de Pato Peluche con Sonido - Resistente al Mordisco, Juguete Suave para Masticar para Razas Medianas y Pequeñas con efectos de Sonido Interactivos, Ideal para Jugar y Entrenamiento, Juguetes para Perros",
          imgs: [
            "img/ganzo/princi.webp",
            "img/ganzo/trespatos.webp",
            "img/ganzo/blanco.webp",
            "img/ganzo/cafe.webp",
            "img/ganzo/gris.webp",
            "img/ganzo/medidas.webp",
            "img/ganzo/perrocon.webp",
            "img/ganzo/perrodurmiendo.webp",
            "img/ganzo/perrosygatos.webp",
            "img/ganzo/principal.webp",
          ],
        },
        {
          nombre: "Distribuidor de Bolsas",
          valor: "$40.000",
          imagen: "img/contenedorbolsa/principal.webp",
          descripcion:
            "Suministros Creativos para Mascotas: Recolector de Excrementos para Paseos de Perros, Práctico y Hermoso Distribuidor de Bolsas de Basura Portátil, Carcasa de Basura Esencial para Amantes de las Mascotas",
          imgs: [
            "img/contenedorbolsa/princi.webp",
            "img/contenedorbolsa/principal.webp",
            "img/contenedorbolsa/medidas.webp",
            "img/contenedorbolsa/cafeprinci.webp",
            "img/contenedorbolsa/imagenpresen.webp",
          ],
        },
        {
          nombre: "3 pelotas para perros",
          valor: "$40.000",
          imagen: "img/Pelotas/Principal.webp",
          descripcion:
            "3 piezas de juguetes de pelota para perros, juguete de goma resistente y sonoro para mascotas, no tóxico y masticable, juego interactivo y salud dental, sin necesidad de batería para razas pequeñas",
          imgs: [
            "img/Pelotas/Principal.webp",
            "img/Pelotas/perrocon.webp",
            "img/Pelotas/cerca.webp",
            "img/Pelotas/medidas.webp",
            "img/Pelotas/mojada.webp",
          ],
        },
        {
          nombre: "Entrenador de Baño para Perros",
          valor: "$50.000",
          imagen: "img/tepete/principal.webp",
          descripcion:
            " Entrenador de Baño para Perros con Césped Artificial Lavable FUKUCHONG - Tamaño Pequeño a Grande, Material Duradero EVA, Diseño Verde y Amarillo para Uso Interior/Exterior, Ideal para Tiendas de Campaña y Entrenamiento de Mascotas",
          imgs: [
            "img/tepete/principal.webp",
            "img/tepete/especifica.webp",
            "img/tepete/medi.webp",
            "img/tepete/medid.webp",
            "img/tepete/medidagrande.webp",
          ],
        },
        {
          nombre: "Disco Volador De Entrenamiento Para Mascotas",
          valor: "$60.000",
          imagen: "img/Disco volador/principal.webp",
          descripcion:
            "1 Unidad, Disco Volador De Entrenamiento Para Mascotas De Color, Con Estampado Liso, Juguete Duradero Para Masticar Para Perros, Suministro ",
          imgs: [
            "img/Disco volador/principal.webp",
            "img/Disco volador/medidas.webp",
            "img/Disco volador/unidad.webp",
            "img/Disco volador/unidaddos.webp",
            "img/Disco volador/naranja.webp",
            "img/Disco volador/rojo.webp",
            "img/Disco volador/verde.webp",
          ],
        },
        {
          nombre: "Bolsa de entrenamiento",
          valor: "$40.000",
          imagen: "img/Bolsa/principal.webp",
          descripcion:
            " Riñonera para premios de perro con dispensador de bolsas para desechos incorporado - Bolsa de entrenamiento y alimentación de poliéster para entrenadores y dueños de mascotas, gran capacidad, diseño con clip para llevar",
          imgs: [
            "img/Bolsa/principal.webp",
            "img/Bolsa/partes.webp",
            "img/Bolsa/medidas.webp",
            "img/Bolsa/bolsa.webp",
            "img/Bolsa/amboslados.webp",
          ],
        },
        {
          nombre: "Peine para Mascota",
          valor: "$30.000",
          imagen: "img/Cepillo para mascotas/principal.webp",
          descripcion:
            "Peine para Mascotas de Fácil Limpieza y Confort Diario, Adecuado para Perros y Gatos con Función Desenredante, Mango Ergonómico, Peine para Pelaje y Cuidado, Gran Ayudante en la Higiene Canina",
          imgs: ["img/Cepillo para mascotas/principal.webp","img/Cepillo para mascotas/perros y gatos.webp","img/Cepillo para mascotas/medidas.webp","img/Cepillo para mascotas/sistema.webp","img/Cepillo para mascotas/sistema2.webp"
          ],
        },
        {
          nombre: "Juguete frisbee disco volador para mascotas",
          valor: "$40.000",
          imagen: "img/frisbi/principal.webp",
          descripcion:
            " Disco Volador Duradero para Entrenamiento de Perros - Resistente a Mordidas, Juguete de Nudo de Cuerda para Limpieza Dental para Todas las Razas",
          imgs: [
            "img/frisbi/principal.webp",
            "img/frisbi/perrocon.webp",
            "img/peluche/medidas.webp",
            "img/frisbi/medidastallam.webp",
            "img/frisbi/medidastallas.webp",
          ],
        },
        {
          nombre: "Comedero para perro",
          valor: "$100.000",
          imagen: "img/comedero/negro.webp",
          descripcion:
            " 1 Juego de Comederos Elevados para Perros, Estante con 4 Alturas Ajustables y 2 Boles de Acero Inoxidable, Sin Deslizamiento para Razas Pequeñas",
          imgs: [
            "img/comedero/principal.webp",
            "img/comedero/perrocon.webp",
            "img/comedero/caracteristicas.webp",
            "img/comedero/negro.webp",
            "img/comedero/partes.webp",
            "img/comedero/taza.webp",
          ],
        },
        {
          nombre: "Juguetes para Masticar con Sonido para Cachorros",
          valor: "$50.000",
          imagen: "img/docepelotas/principal.webp",
          descripcion:
            "6/12pcs Juguetes para Masticar con Sonido para Cachorros - Bolas Interactivas de Plástico Duradero y Estrellas Texturadas, Colores Variados para Perros Pequeños y Medianos, Diseños Divertidos para Mascotas",
          imgs: [
            "img/docepelotas/principal.webp",
            "img/docepelotas/imagenconperro.webp",
            "img/docepelotas/pito.webp",
            "img/docepelotas/medidas.webp",
            "img/docepelotas/perrocon.webp",
          ],
        },
        {
          nombre: "Bolsas para Excrementos de Perro",
          valor: "$40.000",
          imagen: "img/bolsas/principal.webp",
          descripcion:
            "210 Bolsas para Excrementos de Perro a Prueba de Fugas con Diseño de Huellas, 14 Rollos - Bolsas de Plástico Duraderas para Limpieza de Mascotas y Uso Exterior",
          imgs: [
            "img/bolsas/division.webp",
            "img/bolsas/principal.webp",
            "img/bolsas/medidas.webp",
            "img/bolsas/perrocon.webp",
            "img/bolsas/bolsa.webp",
          ],
        },
        {
          nombre: "Bálsamo Hidratante huellas y nariz",
          valor: "$10.000",
          imagen: "img/balsamo/principal.webp",
          descripcion:
            "Crema Anti-Grietas para Garras y Uñas de Mascotas - Bálsamo Hidratante Rápido para Perros y Gatos, Fijación Fuerte, Previene Grietas y Roturas, Suaviza Patas y Nariz - Tubo de 20g para Mascotas Pequeñas a Grandes, Textura Suave, Fórmula Nutritiva, Amigable con las Mascotas, Para Dueños de Perros",
          imgs: [
            "img/balsamo/principal.webp",
            "img/balsamo/gatoyperro.webp",
            "img/balsamo/medidas.webp",
            "img/balsamo/caja.webp",
            "img/balsamo/perrocon.webp",
            "img/balsamo/princi.webp",
          ],
        },
        {
          nombre: "Cepillo de dientes para mascotas",
          valor: "$20.000",
          imagen: "img/cepillodientes/principal.webp",
          descripcion:
            "Conjunto de 4 Cepillos para Dientes de Mascotas con Cerdas Suaves y Mangos Ergonómicos Antideslizantes para un Cuidado Dental Amable - Rosa, Verde, Amarillo, Blanco",
          imgs: [
            "img/cepillodientes/principal.webp",
            "img/cepillodientes/perrocon.webp",
            "img/cepillodientes/medidas.webp",
          ],
        },
      ];

      function renderCart() {
        productos.forEach((item, index) => {
          const div = document.createElement("div");
          div.classList.add("product-card");
          div.innerHTML = `
                <a onclick="verDetalleProducto({
                    nombre: '${item.nombre}',
                    precio: '${item.valor}',
                    descripcion: '${item.descripcion}',
                    imagen: '${item.imagen}',
                    imagenes: '${item.imgs}'})" >
                    <img src="${item.imagen}" alt="${item.nombre}">
                </a>
                <div class="informacion-producto">
                    <div>
                        <p>${item.nombre}</p>
                        <p>${item.valor}</p>
                    </div>
                    <figure>
                        <a href="carrito.html">
                            <img src="icons/bt_add_to_cart.svg" alt="carrito de compra">
                        </a>
                    </figure>
                </div>
            `;
          cartContent.appendChild(div);
        });
      }

      function verDetalleProducto(producto) {
        const imgs = producto.imagenes.split(",");
        producto.imagenes = imgs;
        localStorage.setItem("productoSeleccionado", JSON.stringify(producto));
        window.location.href = "detalleprod.html";
      }

      renderCart();

      // ⇢ 1. Función que recorre todas las tarjetas y arma la lista
      function obtenerListaDeProductos() {
        // Selecciona TODAS las tarjetas dentro de .card-container
        return Array.from(
          document.querySelectorAll(".card-container .product-card")
        ).map((card) => {
          // Imagen principal (la primera dentro del <a>)
          const img = card.querySelector("a img")?.src || "";

          // Nombre (primer <p> dentro de .informacion-producto)
          const nombre = card
            .querySelector(".informacion-producto p:nth-child(1)")
            .textContent.trim();

          // Precio (segundo <p> → quitamos símbolos y puntos)
          const precioTexto = card.querySelector(
            ".informacion-producto p:nth-child(2)"
          ).textContent;
          const precio = Number(precioTexto.replace(/[^0-9]/g, ""));

          return { img, nombre, precio };
        });
      }

      document
        .getElementById("ver-carrito")
        .addEventListener("click", function (e) {
          e.preventDefault(); // Detiene el comportamiento por defecto del enlace
          const productos = obtenerListaDeProductos();
          localStorage.setItem(
            "productosDisponibles",
            JSON.stringify(productos)
          );
          window.location.href = "carrito.html"; // Navega manualmente
        });
      // Simulación de carrito
      let carrito = JSON.parse(localStorage.getItem("carrito")) || [];

      function actualizarCarritoVisual() {
        const cartCountDiv = document.querySelector(
          ".navbar-shopping-cart div"
        );
        const totalItems = carrito.reduce(
          (acc, item) => acc + item.cantidad,
          0
        );
        cartCountDiv.textContent = totalItems;
      }

      function agregarAlCarrito(nombre, precio, img) {
        const productoExistente = carrito.find(
          (item) => item.nombre === nombre
        );
        if (productoExistente) {
          productoExistente.cantidad += 1;
        } else {
          carrito.push({ nombre, precio, cantidad: 1, img });
        }

        localStorage.setItem("carrito", JSON.stringify(carrito));
        actualizarCarritoVisual();
      }

      function volarAlCarrito(imgOrigen) {
        const carritoIcono = document.querySelector(
          ".navbar-shopping-cart img"
        );
        const imgRect = imgOrigen.getBoundingClientRect();
        const carritoRect = carritoIcono.getBoundingClientRect();

        const imgClone = imgOrigen.cloneNode(true);
        imgClone.classList.add("fly-img");
        document.body.appendChild(imgClone);

        // Posición inicial (donde está la imagen original)
        imgClone.style.top = imgRect.top + "px";
        imgClone.style.left = imgRect.left + "px";

        // Forzamos reflow para que el navegador note la posición inicial
        imgClone.offsetWidth;

        // Posición final (el carrito)
        const translateX = carritoRect.left - imgRect.left;
        const translateY = carritoRect.top - imgRect.top;

        imgClone.style.transform = `translate(${translateX}px, ${translateY}px)`;
        imgClone.style.opacity = 0;

        // Eliminar después de la animación
        setTimeout(() => {
          imgClone.remove();
        }, 700);
      }

      document.querySelectorAll(".product-card").forEach((card) => {
        card.querySelector("figure a").addEventListener("click", (e) => {
          e.preventDefault(); // Evita que redirija
          const nombre = card.querySelector(
            ".informacion-producto p:nth-child(1)"
          ).textContent;
          const precioTexto = card.querySelector(
            ".informacion-producto p:nth-child(2)"
          ).textContent;
          const precio = Number(precioTexto.replace(/[^0-9]/g, "")); // $120.000 → 120000

          const imgElement = card.querySelector("img"); // Usamos la imagen del producto
          const src = imgElement.src;
          volarAlCarrito(imgElement); // 🎯 ¡Aquí ocurre la magia!

          agregarAlCarrito(nombre, precio, src);
        });
      });

      actualizarCarritoVisual();
    </script>
  </body>
</html>
